<div [class.start-quiz-side]="startQuiz" class="section-modal">
  <span mat-button mat-dialog-close class="close">
    <us-icon [name]="'close'" [size]="24"></us-icon>
  </span>
  <span *ngIf="modalData.id !== 3 && modalData.id !== -1" class="preview">
    {{ 'global.quiz-modal.course_preview' | translate }}
  </span>
  <span
    *ngIf="modalData.id !== 3 && modalData.id !== -1"
    class="title"
    [innerHTML]="modalData.lesson.title"
  >
  </span>

  <div *ngIf="modalData.id === 1" class="article">
    <p class="text" [innerHTML]="modalData.lesson.article"></p>
  </div>

  <div *ngIf="modalData.id === 2" class="video">
    <div class="video-side">
      <div class="image-and-video">
        <div *ngIf="modalData.lesson.video_url; else cover_image">
          <iframe
            width="100%"
            height="350"
            [src]="videoUrl"
            title="YouTube video player"
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
            allowfullscreen
          ></iframe>
        </div>
      </div>
      <span class="description">
        {{ 'global.quiz-modal.description' | translate }}
      </span>
      <div class="desc-side">
        <p class="desc" [innerHTML]="modalData.lesson.description"></p>
      </div>
    </div>
  </div>

  <div *ngIf="modalData.id === 3 && !startQuiz" class="quiz">
    <ng-container *ngIf="step <= 0">
      <div class="content">
        <span class="title"> {{ 'global.quiz-modal.start_quiz_lesson' | translate }} 1 </span>
        <span class="desc"
          >{{ 'global.quiz-modal.quiz_contains' | translate }}
          {{ modalData.lesson.questions_count }}
          {{ 'global.quiz-modal.quiz_contains_1' | translate }}</span
        >
        <span class="good-luck"> {{ 'global.quiz-modal.good_luck' | translate }}</span>
      </div>
      <div class="bottom-side">
        <button (click)="startQuizAction()" class="btn start">
          {{ 'global.quiz-modal.start' | translate }}
        </button>
        <button mat-button mat-dialog-close class="btn cancel">
          {{ 'global.quiz-modal.cancel' | translate }}
        </button>
      </div>
    </ng-container>
  </div>

  <div *ngIf="startQuiz && modalData.id === 3" class="questions">
    <div class="answer-response" *ngIf="successQuiz">
      <p class="answer-percent">{{ successQuizMessage }}</p>
      <div class="icon">
        <img
          src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAA
        AwCAYAAABXAvmHAAAABmJLR0QA/wD/AP+gvaeTAAAE+UlEQVRoge2ZW2wUVRjHf9+ZotDGSygUUGlKmgg
        FQaVcLL1IJRG6hRYf6iUmhhgiDyYaoIXXfbS0JdHEN58wxgiJ4VZWJXJpl5tRgiBSeTAYNZKWEmMpiN09nw+9Lbszu
        zvNLBrC/23Od/v/Z845880ZuI97GDui9c3t3XVbc1lDcpW4rav+VUQ/AUTRDduqI7tyUScnAlqj9bVGNQI8ODI0JCrrmms6v
        wy6lm8BHcdfnB03eccEDorYPTcqnzsZlrAdte88HloYN3QBjyaFDqg6K7fVHDibOPhedPUCR50moMnGdPX22shvORXQFg29jPJZwtAfw
        H6FvcZxrmg8fhSY6RF+VRyn1sbjJQLrgQZgVgKbV1qqDu32wyfPJ39UWZGkehawSWCTxuOZwmdqPH7J865ZrQB8CTB+nEcCKvzGZA0R37
        l9TaGdJ5umxOODfwIP+C2UJYYcp+CRLSv23Mo2wNcTsHagnNyRB5gUi91Y7CcgqycQPrpycr4zpRyRtwVemxi37KDwKaof3ozf+i5ce+zv
        TP6uAlqjDY8ZHSoHKkGqgHJgcsBcMyEGXFY0CpyYhIluru78OdnJdRcyGjsCMjfXDDMgD5gvyHzgrRjaA5QlO7muAYF9OSaXgvwpBRk81JWTu
        wArd1VA4dRpLH22gtKSJ72djJO9gIGapaeBq4Gwy4DCqdN4at4zGGMofqLES0Tv4IolZ9wMrgLCEraCHAqSqBumFxaxsGyY/ChmP15MQX7KdDqQ2G8lw
        vM9IJLbdVA4dRrz5y5CZJyCquViz3kGbw4mebvPf0jTC1kbv4L47jSywvTCIhbMcyff19+bGqD6i1cuV4at0dASxBwOgGsKfJMHQI60nVjr2ielCOjoWr
        PKKF8DRYEwTsDEyAMihVh7uD1aV5dsukNAe7TudSsmAjycDaHMe/c4Jkx+HAWqsn9Hd92biYNj2dq7Q++qyi5gUjbZSopLWba4gumFmR9UAORH
        kSfIR23d9dtTBPhBSXEpc4pLETEsmLcorYgAybtiLGtz9aH3RfQNYChdQEF+ASWz54xdpxORA/IxRTe2VHe2jtVP9ujoWrPKivmcNOsg8e2ZwI
        yLly/Q23c1V+QHRbSpuSoSSRz0aKdDS4zSSZqdKJ0ItTZY8qr9OM66lsqDp5JNnh80bV1rFiHm+3R5ve4yEOycV/t0S80X591MaRaxmeNtG0Zf
        fy8XLp3D2vE2RcQEvmCNcUo8bZ5RQmM2yfuvX+OHnjtFjCKo3UbVm4t7N6phoxDKtoCbiCC3SkXX7t7d5LjZXAXkd5+pEJjhp0iiiCDJj6Do1x
        k3l7sZXLtRMdKI+q/Sf/0aP/40vNYCJA+AGm0ETiaPu68BpWGihfr6ewMnD6Dwktu46xOwkvfC//FYxc3p3jzY8sKOrrpKEXG9E0HBWKnc+nxn
        ylz39PeTfPINvgVu+2aVPf4ZsINnM7uNw5eAd0KR28A5X5R8QOFsNtMmEf6/B1RTGqrAIPjO7V+AkeQi14CPQRvEccoY/uXkhT5xnDIRWw18AP
        x+h1VTcmeE719MJh47ZU1eD+g+I+wdqFz+TeKhU8fxunpr5Bip3xN/Gaurt1Yf6Bm5joY1vPmhE2eWWWU9SKNjh0775XPXfrOq0bXbKiNfBV0r
        JydX26s6j6KyAbCAKroxF+Rzjrbu0Ja27tCW/5rHfeQS/wK8sC5IUQE8VAAAAABJRU5ErkJggg=="
        />
      </div>
      <button (click)="closeDialog(modalData.quiz_id)" class="ok">
        {{ 'global.quiz-modal.ok' | translate }}
      </button>
    </div>
    <ng-container *ngIf="step >= 0 && !successQuiz">
      <span class="title">{{ 'global.quiz-modal.question_title' | translate }} {{ step + 1 }}</span>
      <div class="question-content">
        <span class="score">{{ step + 1 }}/{{ modalData.lesson.questions_count }}</span>
        <p class="question" [innerHTML]="question?.title"></p>
        <div class="quiz-question">
          <ul class="quiz-ul">
            <form [formGroup]="answerForm">
              <li *ngFor="let answer of question?.answers" class="quiz-li">
                <span class="checkboxes">
                  <input
                    [formControlName]="answer"
                    *ngIf="question?.multiple_choice === 1"
                    type="checkbox"
                    [name]="answer"
                    class="checkbox"
                  />
                  <input
                    formControlName="radio"
                    *ngIf="question?.multiple_choice === 0"
                    type="radio"
                    [value]="answer"
                    name="radio"
                    class="checkbox"
                  />
                </span>
                <span class="quest">{{ answer }}</span>
              </li>
            </form>
          </ul>
        </div>
      </div>
      <div class="bottom-side quiz-bottom">
        <span *ngIf="modalData.lesson.questions_count !== step + 1">
          <button
            (click)="stepAction(true)"
            [class.disabled]="!isOpenNextButton && !modalData.preview"
            class="btn start"
          >
            {{ 'global.quiz-modal.next' | translate }}
          </button>
        </span>

        <ng-container *ngIf="!modalData.preview; else cancel">
          <span *ngIf="modalData.lesson.questions_count === step + 1">
            <button (click)="finishQuiz()" [class.disabled]="answerForm.invalid" class="btn start">
              {{ 'global.quiz-modal.finish' | translate }}
            </button>
          </span>
        </ng-container>

        <ng-template #cancel>
          <button
            mat-dialog-close
            *ngIf="modalData.lesson.questions_count === step + 1"
            class="btn start"
          >
            {{ 'global.quiz-modal.cancel' | translate }}
          </button>
        </ng-template>

        <button (click)="stepAction(false)" [class.disabled]="step < 0" class="btn cancel">
          {{ 'global.quiz-modal.prev' | translate }}
        </button>
      </div>
    </ng-container>
  </div>
  <div *ngIf="modalData.lesson.resources_count === 1" class="pdf">
    <span class="title-resource-main">Download resource</span>
    <div class="resources" *ngFor="let resource of modalData.resources">
      <div class="title-and-file">
        <us-icon [name]="'files-icon'" [size]="30"></us-icon>
        <span class="title-resource">{{ resource.title }}</span>
        <a class="download-icon" target="_blank" [href]="resource.path"
          ><us-icon [name]="'download'" [size]="30"></us-icon
        ></a>
      </div>
    </div>
  </div>

  <ng-container *ngIf="!modalData.preview">
    <button (click)="passTheLesson()" *ngIf="modalData.id !== 3" class="pass-the-lesson">
      Pass the lesson
    </button>
  </ng-container>
</div>

<ng-template #cover_image>
  <img src="../../../../../../assets/images/course-view/no-photo.png" class="no-photo" />
</ng-template>
